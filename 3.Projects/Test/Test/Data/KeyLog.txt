==========创建效率==========
//1.评论(本机)
--连续执行
单次评论主体-执行结束,耗费时间0秒103ms
单次评论主体-执行结束,耗费时间0秒2ms
多条评论详情-执行结束,耗费时间19秒94ms
共计10000次评论
单条评论详情-执行结束,耗费时间0秒2ms
共计10001次评论
--连续执行
单次评论详情-执行结束,耗费时间0秒52ms
共计1次评论
//2.点赞(本机)
--连续执行
单次点赞-执行结束,耗费时间0秒6ms
共计1次点赞
单次点赞-执行结束,耗费时间0秒2ms
共计2次点赞
单次点赞-执行结束,耗费时间0秒1ms
共计3次点赞
多次点赞-执行结束,耗费时间41秒970ms
共计10000次点赞
单次点赞-执行结束,耗费时间0秒8ms
共计10001次点赞
单次点赞-执行结束,耗费时间0秒7ms
共计10002次点赞
单次点赞-执行结束,耗费时间0秒8ms
共计10003次点赞
--连续执行
单次点赞-执行结束,耗费时间0秒99ms
共计1次点赞
//3.评论(远程)
--连续执行
--独立执行
//4.点赞(远程)
--连续执行
--独立执行
//5.查询(远程)(有索引)
单次评论主体-执行结束,耗费时间0s101ms
单次评论主体-执行结束,耗费时间0s0ms
单次评论主体-执行结束,耗费时间0s1ms
单条评论详情-执行结束,耗费时间0s53ms
共计1次评论
单条评论详情-执行结束,耗费时间0s2ms
共计2次评论
多条评论详情-执行结束,耗费时间19s173ms
共计10000次评论
单条评论详情-执行结束,耗费时间0s2ms
共计10001次评论
单条评论详情-执行结束,耗费时间0s3ms
共计10002次评论
单次点赞-执行结束,耗费时间0s7ms
共计1次点赞
单次点赞-执行结束,耗费时间0s0ms
共计2次点赞
单次点赞-执行结束,耗费时间0s1ms
共计3次点赞
多次点赞-执行结束,耗费时间52s572ms
共计10000次点赞
单次点赞-执行结束,耗费时间0s11ms
共计10001次点赞
单次点赞-执行结束,耗费时间0s14ms
共计10002次点赞
单次点赞-执行结束,耗费时间0s14ms
共计10003次点赞
获取最新评论详情列表-执行结束,耗费时间0s32ms
共计10002次评论
获取最新评论详情列表-执行结束,耗费时间0s5ms
共计10002次评论
获取后续评论详情列表-执行结束,耗费时间0s26ms
共计10002次评论
获取后续评论详情列表-执行结束,耗费时间0s5ms
共计10002次评论
//6.查询(本机)(有索引)
--连续执行
获取最新评论详情列表-执行结束,耗费时间0s117ms
共计9906次评论
获取最新评论详情列表-执行结束,耗费时间0s16ms
共计9906次评论
--连续执行
获取后续评论详情列表-执行结束,耗费时间0s133ms
共计9906次评论
获取后续评论详情列表-执行结束,耗费时间0s3ms
共计9906次评论
--连续执行
获取最新评论详情列表-执行结束,耗费时间0s117ms
共计9906次评论
获取最新评论详情列表-执行结束,耗费时间0s2ms
共计9906次评论
获取后续评论详情列表-执行结束,耗费时间0s20ms
共计9906次评论
获取后续评论详情列表-执行结束,耗费时间0s2ms
共计9906次评论
//7.查询(本机)(无索引)
获取最新评论详情列表-执行结束,耗费时间1s173ms
共计9906次评论
获取最新评论详情列表-执行结束,耗费时间0s918ms
共计9906次评论
获取后续评论详情列表-执行结束,耗费时间0s965ms
共计9906次评论
获取后续评论详情列表-执行结束,耗费时间0s910ms
共计9906次评论
//8.查询(远程)(无索引)
--连续执行
单次评论主体-执行结束,耗费时间0s106ms
单次评论主体-执行结束,耗费时间0s2ms
单次评论主体-执行结束,耗费时间0s0ms
单条评论详情-执行结束,耗费时间0s51ms
共计1次评论
单条评论详情-执行结束,耗费时间0s4ms
共计2次评论
多条评论详情-执行结束,耗费时间18s941ms
共计10000次评论
单条评论详情-执行结束,耗费时间0s2ms
共计10001次评论
单条评论详情-执行结束,耗费时间0s2ms
共计10002次评论
单次点赞-执行结束,耗费时间0s6ms
共计1次点赞
单次点赞-执行结束,耗费时间0s2ms
共计2次点赞
单次点赞-执行结束,耗费时间0s1ms
共计3次点赞
多次点赞-执行结束,耗费时间52s569ms
共计10000次点赞
单次点赞-执行结束,耗费时间0s12ms
共计10001次点赞
单次点赞-执行结束,耗费时间0s16ms
共计10002次点赞
单次点赞-执行结束,耗费时间0s17ms
共计10003次点赞
获取最新评论详情列表-执行结束,耗费时间0s126ms
共计10002次评论
获取最新评论详情列表-执行结束,耗费时间0s70ms
共计10002次评论
获取后续评论详情列表-执行结束,耗费时间0s88ms
共计10002次评论
获取后续评论详情列表-执行结束,耗费时间0s70ms
共计10002次评论
==========结论==========
--------Document--------
1=>创建单条Document
连接数据库耗费100ms
数据库连接存在缓存,缓存在Collection级,即不同的Collection独立创建连接缓存
单条插入2ms
数量级不影响插入
3=>
--------Array--------
2=>创建Document内Array内数据
同创建数据 连接数据库耗费100ms
数据量0时单条新增为1~2ms
逐步递增
数据量10000时单条新增为7~8ms
4=>
--------备注--------
以上测试为无索引的情况
--------Query Without Index--------
7=>
建立连接100ms
1W条数据中查询20条最新数据耗费918ms
1W条数据中根据某一条数据查询20往期数据耗费965ms
8=>
建立评论主体连接104ms
建立评论详情连接47ms
单次评论2ms,总评论数量无影响
单次点赞1~2ms,渐增10000条记录时,点赞16~17ms
1W次点赞平均5ms/次
1W条数据中查询20条最新数据耗费70ms首次126ms(包含建立连接)
1W条数据中根据某一条数据查询20往期数据耗费70ms
,首次(70+18+56)ms其中18ms为相关信息查询56为连接开销
--------Indexed Query--------
5=>
建立CommentBody连接100ms
单条数据插入1ms
建立CommentDetail连接50ms
单条数据插入2ms(带索引开销)
1W条评论详情插入 平均2ms/条
1W条数据后单条数据插入2~3ms
单次点赞 7ms 包含首次连接开销7ms
点赞开销从0~1ms渐增至1W条时11ms~14ms
1W条数据中查询20条最新数据耗费5ms,首次查询32ms
1W条数据中根据某一条数据查询20往期数据耗费5ms,首次26ms
6=>
<建立了复合索引(Parent:1,CreateTime:-1)>
建立连接100ms
1W条数据中查询20条最新数据耗费2~3ms之前的16ms可能与线程卡顿有关
1W条数据中根据某一条数据查询20往期数据耗费3ms
(获取往期评论索引的加载开销在17ms可能根据索引文件的大小而变更)
(获取最新评论)所建立的连接对(获取往期评论)同样有效,但某些(获取往期评论)相关的数据(如索引)的获取需要另作开销
--------备注--------
远程测试:
10.12.8.197



==========xxxx==========
==========结论==========
==========xxxx==========
==========结论==========
==========xxxx==========
==========结论==========
==========xxxx==========
==========结论==========
==========xxxx==========
==========结论==========
